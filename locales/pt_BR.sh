#!/bin/bash
# Locale: pt_BR (Portuguese - Brazil)

# --- General ---
MSG_USAGE="Uso"
MSG_COMMANDS="Comandos"
MSG_CMD_CONFIG_DESC="Executar assistente de configuração interativo"
MSG_CMD_PULL_DESC="Baixar chart do KCS (uso: pull [--version X.X.X])"
MSG_CMD_CHECK_DESC="Verificar ambiente e pré-requisitos"
MSG_CMD_PREPARE_DESC="Executar preparação da instalação (requer config)"
MSG_CMD_INSTALL_DESC="Instalar componentes do Kaspersky Container Security"
MSG_CMD_HELP_DESC="Mostrar esta mensagem de ajuda"
MSG_VERSION="Versão"
MSG_AUTHOR="Autor"
MSG_ERROR_CONFIG_NOT_FOUND="Erro: Configuração não encontrada. Por favor execute 'kcspoc config' primeiro."

# --- Helper UI ---
MSG_DEFAULT="Padrão"

# --- Config Command ---
MSG_CONFIG_WIZARD_TITLE="Assistente de Configuração"
MSG_CONFIG_WIZARD_DESC="Este assistente gera o arquivo ~/.kcspoc/config."
MSG_CONFIG_LOADED="Configuração existente carregada."
MSG_CONFIG_SAVED="Configuração salva em"
MSG_CONFIG_VER_UPDATED="Versão do KCS definida para"
MSG_CONFIG_NEXT_STEPS="Próximos passos: execute 'kcspoc check' para verificar seu ambiente."

MSG_STEP_LANG="Idioma Preferido"
MSG_STEP_LANG_DESC="Selecione o idioma da interface."
MSG_INPUT_LANG="Idioma (en_US, pt_BR, etc)"
MSG_LANG_AVAILABLE="Disponível"

MSG_STEP_NS="Namespace Kubernetes"
MSG_STEP_NS_DESC="Onde os recursos do KCS serão criados."
MSG_INPUT_NS="Namespace"

MSG_STEP_DOMAIN="Domínio Base"
MSG_STEP_DOMAIN_DESC="Domínio para console/serviços KCS (ex: kcs.lab)."
MSG_INPUT_DOMAIN="Domínio"

MSG_STEP_REG="Credenciais do Registro"
MSG_STEP_REG_DESC="Acesso às imagens de container do KCS."
MSG_INPUT_REG_URL="URL do Servidor"
MSG_INPUT_REG_USER="Usuário"
MSG_INPUT_REG_PASS="Senha"
MSG_INPUT_REG_EMAIL="Email"

MSG_STEP_METALLB="Intervalo de IP MetalLB"
MSG_STEP_METALLB_DESC="Intervalo para LoadBalancer (ex: 172.16.0.10-172.16.0.20)"
MSG_INPUT_IP_RANGE="Intervalo de IP"

MSG_STEP_DEEP="Inspeção Profunda de Nó"
MSG_STEP_DEEP_DESC="Executar pods privilegiados para verificar disco/headers?"
MSG_INPUT_DEEP="Habilitar Inspeção Profunda? (true/false)"

MSG_STEP_VERSION="Versão do KCS"
MSG_STEP_VERSION_DESC="Versão alvo para instalação."
MSG_INPUT_VERSION="Versão"

# --- Pull Command ---
MSG_PULL_TITLE="Baixando Chart do KCS"
MSG_PULL_AUTH="Autenticando no Registro"
MSG_PULL_LOGIN_OK="Login com Sucesso"
MSG_PULL_LOGIN_FAIL="Falha no Login"
MSG_PULL_LOGIN_ERR="Erro: Não foi possível logar no registro."
MSG_PULL_VER_SRC_FLAG="Fonte da Versão: Flag de Comando"
MSG_PULL_VER_SRC_CONFIG="Fonte da Versão: Arquivo de Config"
MSG_PULL_VER_SRC_DEFAULT="Fonte da Versão: Padrão (latest)"
MSG_PULL_DOWNLOADING="Baixando Chart do KCS..."
MSG_PULL_SUCCESS="Download com sucesso."
MSG_PULL_EXTRACTING="Extraindo"
MSG_PULL_EXTRACTED="Chart extraído para"
MSG_PULL_ERR_FILE="Erro: Arquivo baixado não encontrado!"
MSG_PULL_ERR_FAIL="Falha no helm pull."
MSG_PULL_LOCAL_TITLE="Versões Localmente Disponíveis do KCS"
MSG_PULL_LOCAL_EMPTY="Nenhum artefato local encontrado."
MSG_PULL_TABLE_ACTIVE="Ativo"
MSG_PULL_TABLE_VER="Versão"
MSG_PULL_TABLE_DATE="Baixado em"
MSG_PULL_TABLE_PATH="Caminho"
MSG_PULL_ACTIVE_MARKER="(*) ativo"

# --- Check Command ---
MSG_CHECK_TITLE="Verificação de Ambiente"
MSG_CHECK_TOOLS="Verificando ferramentas CLI..."
MSG_CHECK_TOOLS_FAIL="Ferramentas obrigatórias ausentes"
MSG_CHECK_CONFIG="Verificando Configuração..."
MSG_CHECK_CONFIG_FAIL="FALHA (Variáveis ausentes na config)"
MSG_CHECK_CONFIG_FIX="Execute 'kcspoc config' para corrigir."
MSG_CHECK_CONFIG_CREATE="Execute 'kcspoc config' para criá-lo."
MSG_CHECK_KUBECONFIG="Verificando existência do Kubeconfig..."
MSG_CHECK_KUBECONFIG_FAIL="Kubeconfig não encontrado em ~/.kube/config"
MSG_CHECK_CONN_FAIL="Não foi possível conectar ao cluster Kubernetes"
MSG_CHECK_CONN_ERR="Erro de Conectividade"
MSG_CHECK_RESOURCES_TITLE="=== Recursos & Topologia do Cluster ==="
MSG_CHECK_K8S_VER="Verificando Versão do Kubernetes..."
MSG_CHECK_PASS="Passou"
MSG_CHECK_FAIL="FALHA"
MSG_CHECK_ARCH="Verificando Arquitetura..."
MSG_CHECK_ARCH_MIXED="Arquiteturas Mistas detectadas"
MSG_CHECK_ARCH_WARN="Aviso: Core suporta apenas amd64"
MSG_CHECK_ARCH_NONE="Nenhum nó amd64 encontrado"
MSG_CHECK_RUNTIME="Verificando Container Runtime..."
MSG_CHECK_RUNTIME_WARN="Aviso: Obsoleto"
MSG_CHECK_CNI="Verificando Plugin CNI..."
MSG_CHECK_CNI_DETECTED="Detectado"
MSG_CHECK_CNI_WARN="Aviso: Nenhum pod CNI comum detectado."
MSG_CHECK_NODE_RES_TITLE="Recursos do Nó (CPU / RAM / Disco / Kernel Headers / eBPF):"
MSG_CHECK_DEEP_RUN="Executando Inspeção Profunda (Pods Privilegiados)..."
MSG_CHECK_DEEP_SKIP="(Inspeção Profunda Desabilitada: Info básica apenas)"
MSG_CHECK_REPO_CONN="Verificando Conectividade com Repositório"
MSG_CHECK_GLOBAL_TOTALS="Totais Globais do Cluster"
MSG_CHECK_ALL_PASS="Todas as verificações passaram."
MSG_CHECK_FINAL_FAIL="Verificações falharam. Por favor corrija os problemas acima."

MSG_CHECK_CLOUD_TITLE="Provedor de Nuvem & Topologia"
MSG_CHECK_CLOUD_PROVIDER="Provedor"
MSG_CHECK_CLOUD_REGION="Região"
MSG_CHECK_CLOUD_ZONE="Zona"
MSG_CHECK_CLOUD_OS="Imagem do SO"
MSG_CHECK_CLOUD_UNKNOWN="Desconhecido / Bare Metal"

# Infrastructure Dependencies
MSG_CHECK_INFRA_TITLE="Dependências de Infraestrutura"
MSG_CHECK_INFRA_DESC="Verificando se os componentes necessários para a PoC estão presentes."
MSG_CHECK_INFRA_INSTALLED="Instalado"
MSG_CHECK_INFRA_MISSING="Ausente"

# Status Markers
MSG_CHECK_LABEL_PASS="[ PASS ]"
MSG_CHECK_LABEL_FAIL="[ FALHA ]"
MSG_CHECK_LABEL_WARN="[ AVISO ]"
MSG_CHECK_LABEL_INFO="[ INFO ]"

# Audit Checks
MSG_AUDIT_TITLE="Auditoria de Aderência"
MSG_AUDIT_REF_TABLE="Tabela de Referência (Por Nó)"
MSG_AUDIT_RES="Recurso"
MSG_AUDIT_MIN="Mínimo POC"
MSG_AUDIT_IDEAL="Ideal (High Perf)"
MSG_AUDIT_CPU="CPU (vCPUs)"
MSG_AUDIT_RAM="Memória RAM"
MSG_AUDIT_DISK="Disco (Ephemeral)"
MSG_AUDIT_NODE_EVAL="Avaliação do Nó"
MSG_AUDIT_FAIL_CPU="CPU Insuficiente: Possui %s vCPU(s), necessário %s."
MSG_AUDIT_FAIL_RAM="RAM Insuficiente: Possui %s MiB, necessário %s MiB."
MSG_AUDIT_FAIL_DISK="Disco Insuficiente: Possui %s GiB, necessário %s GiB."
MSG_AUDIT_CAUSE_CPU="Causa: Lentidão crítica na console e falha em scans concorrentes."
MSG_AUDIT_CAUSE_RAM="Causa: Risco de OOMKill (Out of Memory) nos bancos Postgres/Clickhouse."
MSG_AUDIT_CAUSE_DISK="Causa: Bases de vulnerabilidades não serão descompactadas (Scanner Offline)."
MSG_AUDIT_APPROVED="[ STATUS: APROVADO ]"
MSG_AUDIT_REJECTED="[ STATUS: REPROVADO ]"
MSG_AUDIT_SUCCESS="SUCESSO: O ambiente está aderente aos requisitos de POC."
MSG_AUDIT_FAIL="FALHA: O ambiente não atende aos requisitos mínimos em um ou mais nós."
MSG_AUDIT_REC="Recomendação: Ajuste os recursos das máquinas virtuais/instâncias."

# --- Prepare Command ---
MSG_PREPARE_START="Iniciando Preparação..."
MSG_PREPARE_USING_NS="Usando Namespace"
MSG_PREPARE_USING_REG="Usando Registro"
MSG_PREPARE_USING_DOMAIN="Usando Domínio"
MSG_PREPARE_USING_IP="Usando Intervalo IP"
MSG_PREPARE_STEP_1="Configurando Namespace e Auth do Registro..."
MSG_PREPARE_STEP_1_A="Configurando Namespace..."
MSG_PREPARE_STEP_1_B="Configurando Auth do Registro..."
MSG_PREPARE_CREATING_SECRET="Criando secret do registro..."
MSG_PREPARE_STEP_2="Instalando Dependências de Infraestrutura..."
MSG_PREPARE_INSTALL_CERT="Instalando Cert-Manager..."
MSG_PREPARE_INSTALL_LOCAL="Instalando Local Path Provisioner..."
MSG_PREPARE_INSTALL_METRICS="Instalando Metrics Server..."
MSG_PREPARE_STEP_3="Configurando MetalLB..."
MSG_PREPARE_STEP_4="Instalando Ingress-Nginx..."
MSG_PREPARE_STEP_5="Instalando Kernel Headers..."
MSG_PREPARE_SUDO_FAIL="sudo não encontrado, pulando instalação de headers."
MSG_PREPARE_STEP_6="Verificação Final..."
MSG_PREPARE_COMPLETED="Configuração Concluída!"
MSG_PREPARE_INGRESS_IP="IP do Ingress"
MSG_PREPARE_HOSTS_HINT="Adicione isto ao seu /etc/hosts"
MSG_PREPARE_LABEL_INFO="Recursos serão marcados com a label"
MSG_PREPARE_CHECKLIST="Checklist de Instalação"
MSG_PREPARE_UNATTENDED_RUN="Executando em Modo Não-Interativo..."
MSG_PREPARE_INTERACTIVE_WARN="A ferramenta instalará diversos componentes de infraestrutura. Você será questionado antes da instalação de cada um deles."

MSG_PREPARE_PROMPT_INSTALL="Instalar %s? [s/N] "

MSG_PREPARE_WHY_CERT_TITLE="Por que o Cert-Manager?"
MSG_PREPARE_WHY_CERT_DESC="O KCS exige HTTPS para o Admission Controller. O Cert-Manager automatiza certificados para mTLS interno e para a Console Web."

MSG_PREPARE_WHY_STORAGE_TITLE="Por que o Local Path Storage?"
MSG_PREPARE_WHY_STORAGE_DESC="Os bancos de dados do KCS (Postgres/Clickhouse) precisam de persistência. Este provisionador cria volumes usando os discos locais dos nós."

MSG_PREPARE_WHY_METRICS_TITLE="Por que o Metrics Server?"
MSG_PREPARE_WHY_METRICS_DESC="Fornece dados de uso de CPU/RAM para a API do Kubernetes. O dashboard do KCS usa isso para exibir a saúde dos containers e nós."

MSG_PREPARE_WHY_METALLB_TITLE="Por que o MetalLB?"
MSG_PREPARE_WHY_METALLB_DESC="Em ambientes On-Premise, o Kubernetes não fornece IPs externos. O MetalLB atribui um IP real à Console do KCS."

MSG_PREPARE_WHY_INGRESS_TITLE="Por que o Ingress-Nginx?"
MSG_PREPARE_WHY_INGRESS_DESC="Atua como o gateway de entrada. Recebe conexões HTTPS e as encaminha para os serviços internos do KCS."

MSG_PREPARE_WHY_HEADERS_TITLE="Por que Kernel Headers?"
MSG_PREPARE_WHY_HEADERS_DESC="A Segurança de Runtime (eBPF) do KCS precisa dos headers para compilar/carregar módulos no sistema hospedeiro."

# --- Destroy Command ---
MSG_DESTROY_TITLE="Remoção do KCS (Limpeza Profunda)"
MSG_DESTROY_WARN_TITLE="ATENÇÃO: OPERAÇÃO DESTRUTIVA"
MSG_DESTROY_WARN_DESC="Isso removerá completamente o Kaspersky Container Security, incluindo bancos de dados e logs."
MSG_DESTROY_CONFIRM_PHRASE="eu quero remover o kcs do meu cluster %s"
MSG_DESTROY_PROMPT="Por favor digite a frase acima para confirmar:"
MSG_DESTROY_CANCEL="Operação cancelada. Frase de confirmação incorreta."
MSG_DESTROY_START="Iniciando Remoção do KCS..."
MSG_DESTROY_STEP_1="Removendo Helm Release..."
MSG_DESTROY_STEP_2="Removendo Namespace..."
MSG_DESTROY_STEP_3="Limpando PVCs Residuais..."
MSG_DESTROY_STEP_4="Limpando PVs Órfãos..."
MSG_DESTROY_STEP_5="Removendo Webhooks Globais..."
MSG_DESTROY_STEP_6="Removendo RBAC Global (ClusterRoles/Bindings)..."
MSG_DESTROY_DEPS_PROMPT="Deseja remover também as DEPENDÊNCIAS DE INFRA (MetalLB, Ingress, Cert-Manager)? [y/N]"
MSG_DESTROY_DEPS_TITLE="Removendo Dependências de Infraestrutura..."
MSG_DESTROY_DEPS_INGRESS="Removendo Ingress-Nginx..."
MSG_DESTROY_DEPS_METALLB="Removendo MetalLB..."
MSG_DESTROY_DEPS_CERT="Removendo Cert-Manager..."
MSG_DESTROY_DEPS_STORAGE="Removendo Storage Class & Metrics..."
MSG_DESTROY_DEPS_SKIPPED="Dependências de infraestrutura preservadas conforme solicitado."
MSG_DESTROY_REMOVED="Removido"
MSG_DESTROY_NOT_FOUND="Não Encontrado (Pulado)"
MSG_DESTROY_SUCCESS="O KCS foi completamente removido do cluster."
MSG_DESTROY_HINT="Dependências (MetalLB, Cert-Manager) foram preservadas."

# --- Install Command ---
MSG_INSTALL_TITLE="Instalando Kaspersky Container Security"
MSG_INSTALL_CORE_STEP="Instalando componentes Core do KCS"
MSG_INSTALL_AGENTS_STEP="Instalando Agentes de Discovery e Runtime"
MSG_INSTALL_VALUES_NOT_FOUND="Erro: arquivo values-final-211.yaml não encontrado no diretório atual ou em ~/.kcspoc"
MSG_INSTALL_SUCCESS="A instalação do KCS foi iniciada com sucesso."
MSG_INSTALL_HEALTH_CHECK="Executando verificações pós-instalação"
MSG_INSTALL_PVC_STATUS="Verificando Armazenamento Persistente (PVCs)"
MSG_INSTALL_LABEL_CHECK="Verificando Etiquetas de Recursos"
MSG_INSTALL_POD_STATUS="Monitorando Inicialização dos Pods"
MSG_INSTALL_BOOTSTRAP_OK="Verificações iniciais concluídas! O KCS está inicializando corretamente."
MSG_INSTALL_BOOTSTRAP_HINT="Para acompanhar o progresso em tempo real, execute:"

# --- Help System ---
MSG_HELP_DESCRIPTION="Descrição"
MSG_HELP_OPTIONS="Opções"
MSG_HELP_EXAMPLES="Exemplos"

# Config Help
MSG_HELP_CONFIG_DESC="Inicia o assistente de configuração interativo para configurar ou atualizar suas variáveis de ambiente em ~/.kcspoc/config."
MSG_HELP_CONFIG_OPTS="--set-version <ver>|Atualiza rapidamente a versão ativa do KCS sem entrar no assistente."
MSG_HELP_CONFIG_EX="kcspoc config\nkcspoc config --set-version 2.3.0"

# Pull Help
MSG_HELP_PULL_DESC="Baixa o chart Helm do Kaspersky Container Security do registro oficial. Autentica usando as credenciais da sua configuração."
MSG_HELP_PULL_OPTS="--version <ver>|Alveja especificamente uma versão do chart (ex: 2.3.0)\n--list-local|Lista todas as versões de chart já baixadas e disponíveis localmente."
MSG_HELP_PULL_EX="kcspoc pull\nkcspoc pull --version 2.2.0"

# Check Help
MSG_HELP_CHECK_DESC="Realiza um diagnóstico abrangente do seu cluster Kubernetes, incluindo ferramentas, conectividade e auditoria de conformidade de recursos."
MSG_HELP_CHECK_OPTS="--deep|Habilita pods privilegiados para verificar headers de kernel e prontidão do eBPF."
MSG_HELP_CHECK_EX="kcspoc check\nkcspoc check --deep"

# Prepare Help
MSG_HELP_PREPARE_DESC="Orquestra a instalação das dependências de infraestrutura (MetalLB, Nginx, Cert-Manager) e armazenamento local para preparar o KCS."
MSG_HELP_PREPARE_OPTS="--unattended|Instala todos os componentes sem solicitar confirmação do usuário."
MSG_HELP_PREPARE_EX="kcspoc prepare\nkcspoc prepare --unattended"

# Destroy Help
MSG_HELP_DESTROY_DESC="Desinstala com segurança o KCS e seus recursos associados do seu cluster. Inclui limpeza opcional das dependências de infraestrutura."
MSG_HELP_DESTROY_OPTS="--unattended|Ignora confirmações (USE COM CAUTELA)."
MSG_HELP_DESTROY_EX="kcspoc destroy\nkcspoc destroy --unattended"

# Logs Help
MSG_HELP_LOGS_DESC="Gerencia os logs de execução da ferramenta kcspoc. Permite visualizar o histórico e detalhar IDs de execução específicos."
MSG_HELP_LOGS_OPTS="--list [cmd]|Mostra os últimos 10 logs (opcionalmente filtrados por comando)\n--show <hash>|Visualiza a saída completa de depuração para um ID de execução específico\n--cleanup|Exclui todos os logs armazenados em ~/.kcspoc/logs"
MSG_HELP_LOGS_EX="kcspoc logs --list\nkcspoc logs --list prepare\nkcspoc logs --show A1B2C3\nkcspoc logs --cleanup"

# Install Help
MSG_HELP_INSTALL_DESC="Instala os componentes do Kaspersky Container Security usando Helm. Requer 'config' e 'pull' prévios."
MSG_HELP_INSTALL_OPTS="--core|Instala o KCS Core (Backend, Console, Bancos de Dados)\n--agents|Instala os agentes de Discovery e Proteção de Runtime"
MSG_HELP_INSTALL_EX="kcspoc install --core\nkcspoc install --agents"
